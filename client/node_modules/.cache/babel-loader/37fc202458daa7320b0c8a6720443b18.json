{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/avmas/Desktop/dangerzone/client/src/controller/GameController.jsx\";\nimport React from 'react';\nimport Main from '../pages/main';\nimport axios from 'axios';\nimport Display from '../pages/display';\nimport BinarySearchTree from '../functions/binary';\nimport iconPicker from '../functions/iconPicker';\nimport Loading from '../pages/loading';\nimport EndScreen from '../components/EndScreen/EndScreen';\n\nclass GameController extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isHome: false,\n      isPlaying: false,\n      load: true,\n      ended: false,\n      story: [],\n      storyLeft: [],\n      userStats: {\n        health: 100,\n        lost: false\n      },\n      weather: [],\n      population: [1000000, 250000]\n    };\n    this.apiKey = '4774ad80334f760f9b45af484c39e9fe';\n    this.getCoordinates = this.getCoordinates.bind(this);\n    this.getLocation = this.getLocation.bind(this);\n  }\n\n  formatData(arr) {\n    return arr.map(object => {\n      let newTree = new BinarySearchTree();\n      newTree.insertAll(object.scenario);\n      return {\n        intro: object.intro,\n        title: object.title,\n        background: object.background,\n        audio: object.sound,\n        category: object.category,\n        tree: newTree\n      };\n    });\n  }\n\n  getCoordinates(position) {\n    const long = position.coords.longitude;\n    const lat = position.coords.latitude;\n    axios.get('http://api.openweathermap.org/data/2.5/weather?lat=' + lat + '&lon=' + long + '&appid=' + this.apiKey).then(results => {\n      this.setState({\n        weather: iconPicker(results.data)\n      });\n      this.getStoryLine();\n    });\n  }\n\n  getLocation() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(this.getCoordinates);\n    }\n  }\n\n  getStoryLine() {\n    axios.get('http://localhost:8080/story/' + this.state.weather[2]).then(res => {\n      let storyLine = this.formatData(res.data);\n      this.setState({\n        story: storyLine,\n        storyLeft: [...storyLine]\n      });\n    });\n  }\n\n  componentDidMount() {\n    this.getLocation();\n  }\n\n  change() {\n    this.setState({\n      isHome: !this.state.isHome,\n      isPlaying: !this.state.isPlaying\n    });\n  }\n\n  lose(healthLoss, home) {\n    let goHome = home;\n    let newHealth = this.state.userStats.health - healthLoss;\n    let theyLost = false;\n    let ended = false;\n    let isPlaying = !home;\n\n    if (newHealth <= 0) {\n      theyLost = true;\n      newHealth = 0;\n      ended = true;\n      isPlaying = false;\n      goHome = false;\n    }\n\n    let newArr = this.state.storyLeft.slice(1);\n    this.setState({\n      isHome: goHome,\n      ended: ended,\n      storyLeft: newArr,\n      isPlaying: isPlaying,\n      userStats: {\n        health: newHealth,\n        lost: theyLost\n      }\n    });\n  }\n\n  startGame() {\n    this.setState({\n      load: false,\n      isHome: true\n    });\n  }\n\n  render() {\n    if (this.state.isHome) {\n      return React.createElement(Main, {\n        population: this.state.population,\n        health: this.state.userStats,\n        weather: this.state.weather,\n        story: this.state.story,\n        storyLeft: this.state.storyLeft,\n        change: () => this.change(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      });\n    } else if (this.state.isPlaying) {\n      return React.createElement(Display, {\n        health: this.state.userStats,\n        story: this.state.storyLeft[0],\n        change: () => this.change(),\n        lose: (i, x) => this.lose(i, x),\n        nextStory: () => this.nextStory(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      });\n    } else if (this.state.ended) {\n      return React.createElement(EndScreen, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      });\n    } else {\n      return React.createElement(Loading, {\n        startGame: () => this.startGame(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      });\n    }\n  }\n\n}\n\nexport default GameController;","map":{"version":3,"sources":["/mnt/c/Users/avmas/Desktop/dangerzone/client/src/controller/GameController.jsx"],"names":["React","Main","axios","Display","BinarySearchTree","iconPicker","Loading","EndScreen","GameController","Component","constructor","props","state","isHome","isPlaying","load","ended","story","storyLeft","userStats","health","lost","weather","population","apiKey","getCoordinates","bind","getLocation","formatData","arr","map","object","newTree","insertAll","scenario","intro","title","background","audio","sound","category","tree","position","long","coords","longitude","lat","latitude","get","then","results","setState","data","getStoryLine","navigator","geolocation","getCurrentPosition","res","storyLine","componentDidMount","change","lose","healthLoss","home","goHome","newHealth","theyLost","newArr","slice","startGame","render","i","x","nextStory"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Main from '../pages/main';\nimport axios from 'axios';\nimport Display from '../pages/display';\nimport BinarySearchTree from '../functions/binary';\nimport iconPicker from '../functions/iconPicker';\nimport Loading from '../pages/loading';\nimport EndScreen from '../components/EndScreen/EndScreen';\n\nclass GameController extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            isHome: false,\n            isPlaying: false,\n            load: true,\n            ended: false,\n            story: [],\n            storyLeft: [],\n            userStats: {\n                health: 100,\n                lost: false\n            },\n            weather: [],\n            population: [1000000, 250000]\n        }\n        this.apiKey = '4774ad80334f760f9b45af484c39e9fe';\n        this.getCoordinates = this.getCoordinates.bind(this);\n        this.getLocation = this.getLocation.bind(this);\n    }\n\n\n    formatData(arr) {\n        return arr.map(object => {\n            let newTree = new BinarySearchTree()\n            newTree.insertAll(object.scenario)\n            return {\n                intro: object.intro,\n                title: object.title,\n                background: object.background,\n                audio: object.sound,\n                category: object.category,\n                tree: newTree\n            }\n        })\n    }\n\n    getCoordinates(position) {\n        const long = position.coords.longitude;\n        const lat = position.coords.latitude;\n        axios.get('http://api.openweathermap.org/data/2.5/weather?lat='+lat+'&lon='+long+'&appid='+this.apiKey).then(results => {\n          this.setState({\n              weather: iconPicker(results.data)\n          })\n          this.getStoryLine()\n        })\n    }\n\n    getLocation() {\n        if (navigator.geolocation) {\n            navigator.geolocation.getCurrentPosition(this.getCoordinates);\n        }\n    }\n\n    getStoryLine() {\n        axios.get('http://localhost:8080/story/'+this.state.weather[2]).then(res => {\n            let storyLine = this.formatData(res.data)\n            this.setState({\n                story: storyLine,\n                storyLeft: [... storyLine]\n            })\n        })\n    }\n\n    componentDidMount() {\n        this.getLocation();\n    }\n\n    change() {\n        this.setState({\n            isHome: !this.state.isHome,\n            isPlaying: !this.state.isPlaying\n        })\n    }\n\n    lose(healthLoss, home) {\n        let goHome = home;\n        let newHealth = this.state.userStats.health - healthLoss\n        let theyLost = false;\n        let ended = false;\n        let isPlaying = !home;\n        if (newHealth <= 0) {\n            theyLost = true;\n            newHealth = 0;\n            ended = true;\n            isPlaying = false\n            goHome = false\n        }\n        let newArr = this.state.storyLeft.slice(1);\n        this.setState({\n            isHome: goHome,\n            ended: ended,\n            storyLeft: newArr,\n            isPlaying: isPlaying,\n            userStats: {\n                health: newHealth,\n                lost: theyLost\n            }\n        })\n    }\n\n    startGame() {\n        this.setState({\n            load: false,\n            isHome: true\n        })\n    }\n\n    render() {\n        if (this.state.isHome) {\n            return (\n                <Main population={this.state.population} health={this.state.userStats} weather={this.state.weather} story={this.state.story} storyLeft={this.state.storyLeft} change={() => this.change()}/>\n            )\n        } else if (this.state.isPlaying) {\n            return <Display health={this.state.userStats} story={this.state.storyLeft[0]} change={() => this.change()} lose={(i,x) => this.lose(i,x)} nextStory={() => this.nextStory()}/>;\n        } else if (this.state.ended) {\n            return <EndScreen />\n        }\n        else {\n            return <Loading startGame={() => this.startGame()}/>\n        }\n    }\n}\n\nexport default GameController;"]},"metadata":{},"sourceType":"module"}